function initParam(){$.ajax({type:"GET",url:"q/init_param/"+_p+"/"+_qt+"/"+_order_by+"/"+_city_id+"/"+_category_id+"/"+_edu_id+"/"+_salary+"/"+_new+"/"+_premium,success:function(e){param.jobs=e.jobs},complete:function(){j.length<1&&getJobs()}})}function initList(){$(".window__list").animate({scrollTop:0},300);var e=30*(_p-1);if(param.jobs<30)var t=e+param.jobs;else var t=e+30;_p==tp&&(t=e+(param.jobs-30*(tp-1)));var i=$(".window__list ul");i.html("");for(var a=e;t>a;a++)i.append('<li><a href="" class="link--offer clearfix" title="Skaityti darbo skelbimą - Pardavimų ir klientų aptarnavimo vadybininkas (-ė)"><div class="offer-logo"><img src="static/images/l/vp-service.jpg" width="74" height="42"></div><div class="offer-content"><h5>'+j[a].title+'</h5><div class="offer-company">UAB “Venipack”</div><div class="offer-salary">600-1000 €</div></div></a></li>');$("#pg-current").html(_p)}function initMap(){var e=new google.maps.StyledMapType([{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"administrative.country",elementType:"geometry.fill",stylers:[{visibility:"on"}]},{featureType:"administrative.province",elementType:"labels.icon",stylers:[{hue:"#ff0000"},{visibility:"on"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.government",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.medical",elementType:"geometry",stylers:[{visibility:"on"},{color:"#f5e4e4"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{visibility:"on"},{color:"#deefdd"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#f8e491"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{visibility:"off"}]},{featureType:"road.highway.controlled_access",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"transit.station",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"water",elementType:"all",stylers:[{color:"#46bcec"},{visibility:"on"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#78d2ff"}]}],{name:"CV Maps"});map=new google.maps.Map(document.getElementById("map"),{center:{lat:55.1493051,lng:24.2270266},zoom:8,mapTypeControl:!1,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"cvmapsstyle"]}}),map.mapTypes.set("cvmapsstyle",e),map.setMapTypeId("cvmapsstyle"),renderMarkers()}function getMarkers(){$.ajax({type:"GET",url:"m/"+_qt+"/"+_category_id+"/"+_city_id,success:function(e){$.each(e,function(e,t){c.push({id:t.jid,mid:t.mid,lat:t.lat,lng:t.lng})}),groupMarkers(c),initMap()}})}function getJobs(){$.ajax({type:"GET",url:"q/j/"+_p+"/"+_qt+"/"+_order_by+"/"+_city_id+"/"+_category_id+"/"+_edu_id+"/"+_salary+"/"+_new+"/"+_premium,success:function(e){$.each(e,function(e,t){j.push({id:t.id,title:t.title})}),tp=Math.round(param.jobs/30),$("#pg-total").html(tp),initList(),dp.push(_p)}})}function renderMarkers(){for(var e=new google.maps.InfoWindow,t="http://localhost/cvm/static/images/marker_plus.png",i=0;i<c.length;i++)if("undefined"!=typeof c[i].s){t="self"===c[i].s?"http://localhost/cvm/static/images/marker_default.png":"http://localhost/cvm/static/images/marker_plus.png";var a=new google.maps.LatLng(c[i].lat,c[i].lng),r=c[i].mid,s=c[i].id,l=new google.maps.Marker({position:a,map:map,icon:t,marker_id:r,job_id:s});google.maps.event.addListener(l,"click",function(t,i){return function(){$.ajax({type:"GET",url:"q/get_jobs/"+t.job_id,success:function(a){pr.title=a[0].title;var r="";if("self"!==c[i].s){for(var s=[],l=0;l<c[i].s.length;l++)s.push(arrayObjectIndexOf(c,c[i].s[l],"id"));$.ajax({type:"GET",url:"q/get_jobs/"+s,success:function(i){$.each(i,function(e,t){r+=t.title+"<hr/>"}),e.setContent(r),e.open(map,t)}})}else r=pr.title+'<div class="m-company">'+t.job_id+" "+t.marker_id+'UAB “Bite Lietuva”</div><div class="m-price">Nuo 700 EUR</div><a href="" class="m-button">Rodyti skelbimą</a>',e.setContent(r),e.open(map,t)}})}}(l,i)),markers.push(l)}markerCluster=new MarkerClusterer(map,markers,cluster_options)}function wsort(){var e=document.querySelectorAll(".window__sort")[0],t=document.querySelectorAll(".window__list")[0],i=document.querySelectorAll(".window__pagination")[0];""===e.style.display||"none"===e.style.display?(e.style.display="block",t.style.display="none",i.style.display="none"):"block"===e.style.display&&(e.style.display="none",t.style.display="block",i.style.display="block")}function wdropdown(){var e=document.querySelectorAll(".search-field")[0],t=document.querySelectorAll(".search-dropdown")[0];""===t.style.display||"none"===t.style.display?(t.style.display="block",e.style.borderBottomRightRadius="0",e.style.borderBottomLeftRadius="0"):"block"===t.style.display&&(t.style.display="none",e.style.borderBottomRightRadius="",e.style.borderBottomLeftRadius="")}function paginationUpdate(){_p>1&&$("#page-prev").removeClass("btn-disabled"),1===_p&&$("#page-prev").addClass("btn-disabled"),tp>_p&&$("#page-next").removeClass("btn-disabled"),_p===tp&&$("#page-next").addClass("btn-disabled")}function clearMarkers(){for(c=[],$i=0;$i<markers.length;$i++)markers[$i].setMap(null);markers=[],markerCluster.clearMarkers()}function groupMarkers(e){for(var t=e.length,i=[],a=0,r=0;t>r;r++){var s=similarMarkers(e,e[r].lat,e[r].lng);s.length>1?(i[a]=s,a++):1===s.length&&c[r].id===s[0]&&(c[r].s="self")}for(var r=0;t>r;r++)for(var l=0;l<i.length;l++)c[r].id===i[l][0]&&(c[r].s=i[l]);return i}function similarMarkers(e,t,i){for(var a=[],r=0;r<e.length;r++)e[r].lat===t&&e[r].lng===i&&a.push(e[r].id);return a}function arrayObjectIndexOf(e,t,i){for(var a=0,r=e.length;r>a;a++)if(e[a][i]===t)return a;return-1}function countPages(){return Math.round(param.jobs/30)}var map,markers=[],markerCluster={},_p=1,_qt=0,_order_by="date_desc",_city_id=0,_category_id=0,_edu_id=0,_salary=0,_new=0,_premium=0,c=[],j=[],tp=0,param={jobs:0},dp=[],pr={},cluster_options={imagePath:"http://localhost/cvm/static/images/m",gridSize:50,maxZoom:14};initParam(),$("#search").submit(function(e){e.preventDefault(),_qt=$(".search-text").val(),_qt=""!=_qt?_qt:0,j=[],initParam(),$.ajax({type:"GET",url:"m/"+_qt+"/"+_category_id+"/"+_city_id,success:function(e){clearMarkers(),$.each(e,function(e,t){c.push({id:t.jid,mid:t.mid,lat:t.lat,lng:t.lng})}),groupMarkers(c),renderMarkers()}})}),$("#city_id").on("change",function(){_city_id=parseInt($("#city_id").val()),j=[],initParam(),$.ajax({type:"GET",url:"m/"+_qt+"/"+_category_id+"/"+_city_id,success:function(e){$.ajax({type:"GET",url:"m/"+_qt+"/"+_category_id+"/"+_city_id,success:function(e){clearMarkers(),$.each(e,function(e,t){c.push({id:t.jid,mid:t.mid,lat:t.lat,lng:t.lng})}),groupMarkers(c),renderMarkers()}})}})}),$("#category_id").on("change",function(){_category_id=parseInt($("#category_id").val()),j=[],initParam(),$.ajax({type:"GET",url:"m/"+_qt+"/"+_category_id+"/"+_city_id,success:function(e){$.ajax({type:"GET",url:"m/"+_qt+"/"+_category_id+"/"+_city_id,success:function(e){clearMarkers(),$.each(e,function(e,t){c.push({id:t.jid,mid:t.mid,lat:t.lat,lng:t.lng})}),groupMarkers(c),renderMarkers()}})}})}),$("#window_sort_close").click(function(){wsort()}),$("#page-prev").on("click",function(){_p>1&&(_p-=1,paginationUpdate(),initList())}),$("#page-next").on("click",function(){tp>_p&&(_p+=1,paginationUpdate(),dp.indexOf(_p)>-1?initList():getJobs())});